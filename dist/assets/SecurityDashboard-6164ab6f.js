import{j as e}from"./components-2ff98074.js";import{r as s}from"./react-vendor-895c0cc1.js";import{C as t,d as a,a as r,b as c,e as i,B as l}from"./tools-1a80b7de.js";import{A as n,m as d}from"./framer-motion-c36ba6cf.js";import{ac as m,X as x,R as o,a8 as h,a4 as j,a1 as p,E as b,T as g,ad as N,J as v,ae as y,af as u,ag as f,ah as w,ai as k,S,D}from"./lucide-react-1193fca4.js";const T=({isOpen:T,onClose:C})=>{const[z,O]=s.useState(null),[M,_]=s.useState(!1),[P,A]=s.useState("overview"),[B,R]=s.useState(!1);s.useEffect(()=>{T&&E()},[T]);const E=async()=>{_(!0),setTimeout(()=>{const e={overview:{score:Math.floor(20*Math.random())+80,threats:Math.floor(10*Math.random()),blocked:Math.floor(50*Math.random())+20,lastScan:(new Date).toISOString()},policies:{csp:!0,hsts:!0,xss:!0,clickjacking:!0,csrf:!0,mixedContent:!1},threats:[{type:"csp_violation",timestamp:new Date(Date.now()-3e5).toISOString(),message:"Script blocked by Content Security Policy",severity:"medium"},{type:"xss_attempt",timestamp:new Date(Date.now()-6e5).toISOString(),message:"Suspicious script injection detected",severity:"high"},{type:"csrf_attempt",timestamp:new Date(Date.now()-9e5).toISOString(),message:"Invalid CSRF token detected",severity:"high"}],statistics:{totalThreats:15,threatsByType:{csp_violation:5,xss_attempt:3,csrf_attempt:2,clickjacking_attempt:1,data_exfiltration_attempt:4},threatsByHour:{10:2,11:1,12:3,13:2,14:1,15:4,16:2}},dataProtection:{encryption:!0,anonymization:!0,consent:!0,dataRetention:"30 days",gdprCompliant:!0},monitoring:{active:!0,realTime:!0,alerts:!0,reporting:!0}};O(e),_(!1)},1e3)},I=e=>{switch(e){case"high":return"text-red-400 bg-red-500/20 border-red-500/30";case"medium":return"text-yellow-400 bg-yellow-500/20 border-yellow-500/30";case"low":return"text-green-400 bg-green-500/20 border-green-500/30";default:return"text-accent bg-accent/20 border-accent/30"}},H=[{id:"overview",label:"Overview",icon:m},{id:"threats",label:"Threats",icon:h},{id:"policies",label:"Policies",icon:N},{id:"data",label:"Data Protection",icon:u},{id:"monitoring",label:"Monitoring",icon:j}];return T?e.jsx(n,{children:e.jsx(d.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:e=>{e.target===e.currentTarget&&C()},children:e.jsxs(d.div,{initial:{y:20},animate:{y:0},exit:{y:20},className:"w-full max-w-6xl max-h-[90vh] overflow-y-auto bg-primary/95 backdrop-blur-sm border border-accent/20 rounded-xl shadow-lg",children:[e.jsx("div",{className:"p-6 border-b border-accent/20",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-red-500/20 to-orange-500/20 rounded-full flex items-center justify-center",children:e.jsx(m,{className:"w-5 h-5 text-red-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-light",children:"Security Dashboard"}),e.jsx("p",{className:"text-sm text-accent/60",children:"Monitor and manage security threats"})]})]}),e.jsx("button",{onClick:C,className:"p-2 hover:bg-accent/10 rounded-full transition-colors",children:e.jsx(x,{className:"w-5 h-5 text-accent"})})]})}),e.jsx("div",{className:"px-6 py-4 border-b border-accent/20",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:H.map(s=>{const t=s.icon;return e.jsxs("button",{onClick:()=>A(s.id),className:"flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors "+(P===s.id?"bg-red-500/20 text-red-400 border border-red-500/30":"text-accent/80 hover:text-light hover:bg-accent/10"),children:[e.jsx(t,{className:"w-4 h-4"}),s.label]},s.id)})})}),e.jsx("div",{className:"p-6",children:M?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(o,{className:"w-8 h-8 text-accent animate-spin"}),e.jsx("span",{className:"ml-2 text-accent",children:"Loading security data..."})]}):z?e.jsxs(e.Fragment,{children:["overview"===P&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(t,{className:"bg-primary/50 backdrop-blur-sm border border-accent/20",children:e.jsxs(a,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-light",children:"Security Score"}),e.jsx(m,{className:"w-6 h-6 text-green-400"})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"p-6 rounded-xl border "+($=z.overview.score,$>=90?"bg-green-500/20 border-green-500/30":$>=70?"bg-yellow-500/20 border-yellow-500/30":"bg-red-500/20 border-red-500/30"),children:[e.jsx("div",{className:"text-4xl font-bold text-light",children:z.overview.score}),e.jsx("div",{className:"text-sm text-accent/60",children:"/ 100"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"w-full bg-primary/30 rounded-full h-3 mb-2",children:e.jsx(d.div,{className:"bg-green-500 h-3 rounded-full",initial:{width:0},animate:{width:`${z.overview.score}%`},transition:{duration:1}})}),e.jsx("p",{className:"text-sm text-accent/80",children:z.overview.score>=90?"Excellent security posture!":z.overview.score>=70?"Good security with room for improvement":"Security needs immediate attention"})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(t,{className:"bg-primary/50 backdrop-blur-sm border border-accent/20",children:e.jsxs(a,{className:"p-4 text-center",children:[e.jsx(h,{className:"w-8 h-8 text-yellow-400 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-light",children:z.overview.threats}),e.jsx("div",{className:"text-sm text-accent/80",children:"Active Threats"})]})}),e.jsx(t,{className:"bg-primary/50 backdrop-blur-sm border border-accent/20",children:e.jsxs(a,{className:"p-4 text-center",children:[e.jsx(m,{className:"w-8 h-8 text-green-400 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-light",children:z.overview.blocked}),e.jsx("div",{className:"text-sm text-accent/80",children:"Threats Blocked"})]})}),e.jsx(t,{className:"bg-primary/50 backdrop-blur-sm border border-accent/20",children:e.jsxs(a,{className:"p-4 text-center",children:[e.jsx(j,{className:"w-8 h-8 text-accent mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-light",children:"24/7"}),e.jsx("div",{className:"text-sm text-accent/80",children:"Monitoring"})]})})]}),e.jsxs(t,{className:"bg-primary/50 backdrop-blur-sm border border-accent/20",children:[e.jsx(r,{children:e.jsxs(c,{className:"text-light flex items-center gap-2",children:[e.jsx(j,{className:"w-5 h-5 text-accent"}),"Recent Security Activity"]})}),e.jsx(a,{children:e.jsx("div",{className:"space-y-3",children:z.threats.slice(0,5).map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-primary-dark rounded-lg border border-accent/20",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(h,{className:"w-4 h-4 text-yellow-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-light",children:s.message}),e.jsx("div",{className:"text-xs text-accent/60",children:new Date(s.timestamp).toLocaleString()})]})]}),e.jsx(i,{className:I(s.severity),children:s.severity})]},t))})})]})]}),"threats"===P&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(t,{className:"bg-primary/50 backdrop-blur-sm border border-accent/20",children:[e.jsx(r,{children:e.jsxs(c,{className:"text-light flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"w-5 h-5 text-accent"}),"Security Threats"]}),e.jsxs(l,{onClick:()=>R(!B),variant:"outline",size:"sm",children:[B?e.jsx(p,{className:"w-4 h-4 mr-2"}):e.jsx(b,{className:"w-4 h-4 mr-2"}),B?"Hide":"Show"," Details"]})]})}),e.jsx(a,{children:e.jsx("div",{className:"space-y-3",children:z.threats.map((s,t)=>e.jsxs("div",{className:"p-4 bg-primary-dark rounded-lg border border-accent/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"w-4 h-4 text-yellow-400"}),e.jsx("span",{className:"text-sm font-medium text-light",children:s.type.replace(/_/g," ").toUpperCase()})]}),e.jsx(i,{className:I(s.severity),children:s.severity})]}),e.jsx("div",{className:"text-sm text-accent/80 mb-2",children:s.message}),e.jsx("div",{className:"text-xs text-accent/60",children:new Date(s.timestamp).toLocaleString()}),B&&e.jsx("div",{className:"mt-3 p-2 bg-primary/50 rounded text-xs text-accent/60",children:e.jsx("pre",{children:JSON.stringify(s,null,2)})})]},t))})})]}),e.jsxs(t,{className:"bg-primary/50 backdrop-blur-sm border border-accent/20",children:[e.jsx(r,{children:e.jsxs(c,{className:"text-light flex items-center gap-2",children:[e.jsx(g,{className:"w-5 h-5 text-accent"}),"Threat Statistics"]})}),e.jsx(a,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-light mb-3",children:"Threats by Type"}),e.jsx("div",{className:"space-y-2",children:Object.entries(z.statistics.threatsByType).map(([s,t])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-accent/80 capitalize",children:s.replace(/_/g," ")}),e.jsx(i,{className:"bg-accent/20 text-accent border-accent/30 text-sm font-medium",children:t})]},s))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-light mb-3",children:"Threats by Hour"}),e.jsx("div",{className:"space-y-2",children:Object.entries(z.statistics.threatsByHour).map(([s,t])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-accent/80",children:[s,":00"]}),e.jsx(i,{className:"bg-accent/20 text-accent border-accent/30 text-sm font-medium",children:t})]},s))})]})]})})]})]}),"policies"===P&&e.jsx("div",{className:"space-y-6",children:e.jsxs(t,{className:"bg-primary/50 backdrop-blur-sm border border-accent/20",children:[e.jsx(r,{children:e.jsxs(c,{className:"text-light flex items-center gap-2",children:[e.jsx(N,{className:"w-5 h-5 text-accent"}),"Security Policies"]})}),e.jsx(a,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(z.policies).map(([s,t])=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-primary-dark rounded-lg border border-accent/20",children:[e.jsx("span",{className:"text-sm text-light capitalize",children:s.replace(/([A-Z])/g," $1").trim()}),t?e.jsx(v,{className:"w-5 h-5 text-green-400"}):e.jsx(y,{className:"w-5 h-5 text-red-400"})]},s))})})]})}),"data"===P&&e.jsx("div",{className:"space-y-6",children:e.jsxs(t,{className:"bg-primary/50 backdrop-blur-sm border border-accent/20",children:[e.jsx(r,{children:e.jsxs(c,{className:"text-light flex items-center gap-2",children:[e.jsx(u,{className:"w-5 h-5 text-accent"}),"Data Protection"]})}),e.jsxs(a,{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(z.dataProtection).map(([s,t])=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-primary-dark rounded-lg border border-accent/20",children:[e.jsx("span",{className:"text-sm text-light capitalize",children:s.replace(/([A-Z])/g," $1").trim()}),"boolean"==typeof t?t?e.jsx(v,{className:"w-5 h-5 text-green-400"}):e.jsx(y,{className:"w-5 h-5 text-red-400"}):e.jsx("span",{className:"text-sm text-accent",children:t})]},s))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(l,{variant:"outline",size:"sm",children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),"Manage Encryption"]}),e.jsxs(l,{variant:"outline",size:"sm",children:[e.jsx(w,{className:"w-4 h-4 mr-2"}),"Privacy Settings"]}),e.jsxs(l,{variant:"outline",size:"sm",className:"text-red-400 hover:bg-red-500/20",children:[e.jsx(k,{className:"w-4 h-4 mr-2"}),"Clear Data"]})]})]})]})}),"monitoring"===P&&e.jsx("div",{className:"space-y-6",children:e.jsxs(t,{className:"bg-primary/50 backdrop-blur-sm border border-accent/20",children:[e.jsx(r,{children:e.jsxs(c,{className:"text-light flex items-center gap-2",children:[e.jsx(j,{className:"w-5 h-5 text-accent"}),"Security Monitoring"]})}),e.jsxs(a,{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(z.monitoring).map(([s,t])=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-primary-dark rounded-lg border border-accent/20",children:[e.jsx("span",{className:"text-sm text-light capitalize",children:s.replace(/([A-Z])/g," $1").trim()}),"boolean"==typeof t?t?e.jsx(v,{className:"w-5 h-5 text-green-400"}):e.jsx(y,{className:"w-5 h-5 text-red-400"}):e.jsx("span",{className:"text-sm text-accent",children:t})]},s))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(l,{variant:"outline",size:"sm",children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"Configure Alerts"]}),e.jsxs(l,{variant:"outline",size:"sm",children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Export Report"]})]})]})]})})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(h,{className:"w-12 h-12 text-accent/60 mx-auto mb-4"}),e.jsx("p",{className:"text-accent/80",children:"Failed to load security data"}),e.jsxs(l,{onClick:E,className:"mt-4",children:[e.jsx(o,{className:"w-4 h-4 mr-2"}),"Retry"]})]})})]})})}):null;var $};export{T as default};
